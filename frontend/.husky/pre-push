#!/bin/sh
set -e

protected_branch="main"

while read local_ref local_sha remote_ref remote_sha; do
  if echo "$remote_ref" | grep -q "refs/heads/${protected_branch}$"; then
    echo "‚ùå Direct push to '${protected_branch}' is not allowed!"
    echo ""
    echo "   Please create a pull request instead:"
    echo "   1. git checkout -b feature/your-feature"
    echo "   2. git push -u origin feature/your-feature"
    echo "   3. Create PR on GitHub"
    echo ""
    exit 1
  fi
done
